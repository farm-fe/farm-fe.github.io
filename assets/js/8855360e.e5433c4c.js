"use strict";(self.webpackChunkfarm_docs=self.webpackChunkfarm_docs||[]).push([[4775],{9936:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>d,contentTitle:()=>i,default:()=>a,frontMatter:()=>o,metadata:()=>l,toc:()=>c});var s=r(6070),t=r(5658);const o={},i="Dev Server Options",l={id:"config/dev-server",title:"Dev Server Options",description:"DevServer Options - server",source:"@site/docs/config/dev-server.md",sourceDirName:"config",slug:"/config/dev-server",permalink:"/docs/config/dev-server",draft:!1,unlisted:!1,editUrl:"https://github.com/farm-fe/farm-fe.github.io/tree/main/docs/config/dev-server.md",tags:[],version:"current",frontMatter:{},sidebar:"configSidebar",previous:{title:"Compiler Options",permalink:"/docs/config/compilation-options"},next:{title:"Shared Options",permalink:"/docs/config/shared"}},d={},c=[{value:"DevServer Options - server",id:"devserver-options---server",level:2},{value:"port",id:"port",level:3},{value:"https",id:"https",level:3},{value:"headers",id:"headers",level:3},{value:"strictPort",id:"strictport",level:3},{value:"cors",id:"cors",level:3},{value:"spa",id:"spa",level:3},{value:"hmr",id:"hmr",level:3},{value:"<code>hmr.port</code>",id:"hmrport",level:4},{value:"<code>hmr.host</code>",id:"hmrhost",level:4},{value:"proxy",id:"proxy",level:3},{value:"open",id:"open",level:3},{value:"host",id:"host",level:3},{value:"middlewares",id:"middlewares",level:3},{value:"writeToDisk",id:"writetodisk",level:2}];function h(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h1,{id:"dev-server-options",children:"Dev Server Options"}),"\n",(0,s.jsx)(n.h2,{id:"devserver-options---server",children:"DevServer Options - server"}),"\n",(0,s.jsx)(n.p,{children:"Configure the behavior of Farm Dev Server. Example:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:'import { defineConfig } from "@farmfe/core";\n\nexport default defineConfig({\n  // All dev server options are under server\n  server: {\n    port: 9000,\n    //...\n  },\n});\n'})}),"\n",(0,s.jsx)(n.p,{children:"type:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"export interface UserServerConfig {\n  headers?: OutgoingHttpHeaders | undefined;\n  port?: number;\n  https?: SecureServerOptions;\n  protocol?: 'http' | 'https';\n  // http2?: boolean;\n  hmr?: boolean | UserHmrConfig;\n  proxy?: Record<string, ProxiesOptions>;\n  strictPort?: boolean;\n  open?: boolean;\n  host?: string | boolean;\n  cors?: boolean | cors.Options;\n  // whether to serve static assets in spa mode, default to true\n  spa?: boolean;\n  middlewares?: DevServerMiddleware[];\n  writeToDisk?: boolean;\n}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"port",children:"port"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"default"}),": ",(0,s.jsx)(n.code,{children:"9000"})]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"The port the DevServer listens on."}),"\n",(0,s.jsx)(n.h3,{id:"https",children:"https"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"default"}),": ",(0,s.jsx)(n.code,{children:"undefined"})]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["Enable  TLS  + HTTP2. The value is ",(0,s.jsx)(n.a,{href:"https://nodejs.org/api/http2.html#http2createsecureserveroptions-onrequesthandler",children:"options"})," that passes to ",(0,s.jsx)(n.a,{href:"https://nodejs.org/api/http2.html#http2createsecureserveroptions-onrequesthandler",children:"http2.createSecureServer"}),"."]}),"\n",(0,s.jsx)(n.admonition,{type:"note",children:(0,s.jsxs)(n.p,{children:["Note that a ",(0,s.jsx)(n.strong,{children:"valid certificate"})," is needed if ",(0,s.jsx)(n.code,{children:"https"})," enabled."]})}),"\n",(0,s.jsx)(n.h3,{id:"headers",children:"headers"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"default"}),": ",(0,s.jsx)(n.code,{children:"undefined"})]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"Setup global http response headers for the DevServer."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"import { defineConfig } from '@farmfe/core'\n\nexport default defineConfig({\n  server: {\n    headers: {\n      'Accept': 'xxxx'\n    }\n  }\n})\n"})}),"\n",(0,s.jsx)(n.h3,{id:"strictport",children:"strictPort"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"default"}),": ",(0,s.jsx)(n.code,{children:"false"})]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["By default, Farm will automatically resolve to a new port when given port is used. For example, if ",(0,s.jsx)(n.code,{children:"9001"})," is used, then ",(0,s.jsx)(n.code,{children:"9001"})," will be tried. But if ",(0,s.jsx)(n.code,{children:"strictPort"})," is ",(0,s.jsx)(n.code,{children:"true"}),", a error will be thrown when port conflicts, instead of try other ports automatically."]}),"\n",(0,s.jsx)(n.h3,{id:"cors",children:"cors"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"default"}),": ",(0,s.jsx)(n.code,{children:"false"})]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["Configure ",(0,s.jsx)(n.a,{href:"https://www.npmjs.com/package/@koa/cors",children:"@koa/cors options"}),"."]}),"\n",(0,s.jsx)(n.h3,{id:"spa",children:"spa"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"default"}),": ",(0,s.jsx)(n.code,{children:"true"})]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["Enable fallback to ",(0,s.jsx)(n.code,{children:"index.html"})," or not."]}),"\n",(0,s.jsx)(n.h3,{id:"hmr",children:"hmr"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"default"}),": ",(0,s.jsx)(n.code,{children:"true"})," for start command, false for other commands"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"Enable HMR. After enabling the HMR capability, it will monitor the changes of the modules involved in the compilation process. When the modules change, it will automatically trigger recompilation and push the results to Farm Runtime for update. HMR can also be configured through an object, for example:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"import { defineConfig } from '@farmfe/core';\n\nexport default defineConfig({\n   // All dev server options are under server\n   server: {\n     hmr: {\n       // Configure the port for web socket listening\n       port: 9802\n       // Configure the host for web socket listening\n       host: 'localhost',\n       // Files to ignore when configuring file monitoring\n       ignores: ['auto_generated/*']\n     }\n     //...\n   }\n});\n"})}),"\n",(0,s.jsx)(n.h4,{id:"hmrport",children:(0,s.jsx)(n.code,{children:"hmr.port"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"default"}),": ",(0,s.jsx)(n.code,{children:"9801"})]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"The port the Web Socket server listens on"}),"\n",(0,s.jsx)(n.h4,{id:"hmrhost",children:(0,s.jsx)(n.code,{children:"hmr.host"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"default"}),": ",(0,s.jsx)(n.code,{children:"localhost"})]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"Host on which the Web Socket server listens."}),"\n",(0,s.jsx)(n.h3,{id:"proxy",children:"proxy"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Default value"}),": ",(0,s.jsx)(n.code,{children:"undefined"})]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["Configure server proxy. farm uses ",(0,s.jsx)(n.code,{children:"http-proxy"})," as a proxy for the development server. Based on ",(0,s.jsx)(n.a,{href:"https://github.com/http-party/node-http-proxy?tab=readme-ov-file#options",children:"http-proxy"})," implementation, specific options refer to its documentation, example:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:'import { defineConfig } from "@farmfe/core";\n\nexport default defineConfig({\n  server: {\n    proxy: {\n      "/api": {\n        target: "https://music-erkelost.vercel.app/banner",\n        changeOrigin: true,\n        pathRewrite: (path: any) => path.replace(/^\\/api/, ""),\n      },\n    },\n  },\n});\n'})}),"\n",(0,s.jsx)(n.h3,{id:"open",children:"open"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"default"}),": ",(0,s.jsx)(n.code,{children:"false"})]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"After the compilation is completed, the browser is automatically opened to the corresponding page."}),"\n",(0,s.jsx)(n.h3,{id:"host",children:"host"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"default"}),": ",(0,s.jsx)(n.code,{children:"localhost"})]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"The host that the Dev Server listens on."}),"\n",(0,s.jsx)(n.h3,{id:"middlewares",children:"middlewares"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"default"}),": ",(0,s.jsx)(n.code,{children:"[]"})]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"Configuring middlewares for the dev server."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"import { defineConfig } from \"@farmfe/core\";\nimport compression from 'koa-compress';\n\nexport default defineConfig({\n  server: {\n    middlewares: [\n      compression\n    ]\n  },\n});\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Note that a ",(0,s.jsx)(n.code,{children:"middleware"})," is a function that returns a koa middleware."]}),"\n",(0,s.jsx)(n.h2,{id:"writetodisk",children:"writeToDisk"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"default"}),": ",(0,s.jsx)(n.code,{children:"false"})]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["By default the compiled resources are stored and served in memory, set ",(0,s.jsx)(n.code,{children:"writeToDisk"})," to ",(0,s.jsx)(n.code,{children:"true"})," to emitted dev resources to the disk."]})]})}function a(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(h,{...e})}):h(e)}},5658:(e,n,r)=>{r.d(n,{R:()=>i,x:()=>l});var s=r(758);const t={},o=s.createContext(t);function i(e){const n=s.useContext(o);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:i(e.components),s.createElement(o.Provider,{value:n},e.children)}}}]);
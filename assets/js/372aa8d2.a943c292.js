"use strict";(self.webpackChunkfarm_docs=self.webpackChunkfarm_docs||[]).push([[7119],{8374:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>c,contentTitle:()=>t,default:()=>a,frontMatter:()=>s,metadata:()=>l,toc:()=>d});var o=r(6070),i=r(5296);const s={},t="Dev Server",l={id:"config/dev-server",title:"Dev Server",description:"DevServer Options - server",source:"@site/versioned_docs/version-0.x/config/dev-server.md",sourceDirName:"config",slug:"/config/dev-server",permalink:"/docs/0.x/config/dev-server",draft:!1,unlisted:!1,editUrl:"https://github.com/farm-fe/farm-fe.github.io/tree/main/versioned_docs/version-0.x/config/dev-server.md",tags:[],version:"0.x",frontMatter:{},sidebar:"configSidebar",previous:{title:"Configuration Reference",permalink:"/docs/0.x/config/compilation-options"},next:{title:"Environment variable",permalink:"/docs/0.x/config/environment-variable"}},c={},d=[{value:"DevServer Options - server",id:"devserver-options---server",level:2},{value:"port",id:"port",level:3},{value:"hmr",id:"hmr",level:3},{value:"<code>hmr.port</code>",id:"hmrport",level:4},{value:"<code>hmr.host</code>",id:"hmrhost",level:4},{value:"proxy",id:"proxy",level:3},{value:"open",id:"open",level:3},{value:"plugins",id:"plugins",level:3}];function h(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.h1,{id:"dev-server",children:"Dev Server"}),"\n",(0,o.jsx)(n.h2,{id:"devserver-options---server",children:"DevServer Options - server"}),"\n",(0,o.jsx)(n.p,{children:"Configure the behavior of Farm Dev Server. Example:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-ts",children:'import { defineConfig } from "@farmfe/core";\n\nexport default defineConfig({\n  // All dev server options are under server\n  server: {\n    port: 9000,\n    //...\n  },\n});\n'})}),"\n",(0,o.jsx)(n.p,{children:"type:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-ts",children:'export interface UserServerConfig {\n  port?: number;\n  // https?: boolean;\n  protocol?: "http" | "https";\n  hostname?: string;\n  // http2?: boolean;\n  hmr?: boolean | UserHmrConfig;\n  proxy?: Record<string, ProxiesOptions>;\n  strictPort?: boolean;\n  open?: boolean;\n  host?: string;\n  cors?: boolean | cors.Options;\n  //whether to serve static assets in spa mode, default to true\n  spa?: boolean;\n  plugins?: DevServerPlugin[];\n  writeToDisk?: boolean;\n}\n'})}),"\n",(0,o.jsx)(n.h3,{id:"port",children:"port"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"default"}),": ",(0,o.jsx)(n.code,{children:"9000"})]}),"\n"]}),"\n",(0,o.jsx)(n.p,{children:"The port the DevServer listens on."}),"\n",(0,o.jsx)(n.h3,{id:"hmr",children:"hmr"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"default"}),": ",(0,o.jsx)(n.code,{children:"true"})," for start command, false for other commands"]}),"\n"]}),"\n",(0,o.jsx)(n.p,{children:"Enable HMR. After enabling the HMR capability, it will monitor the changes of the modules involved in the compilation process. When the modules change, it will automatically trigger recompilation and push the results to Farm Runtime for update. HMR can also be configured through an object, for example:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-ts",children:"import type { UserConfig } from '@farmfe/core';\n\nfunction defineConfig(config: UserConfig) {\n   return config;\n}\n\nexport default defineConfig({\n   // All dev server options are under server\n   server: {\n     hmr: {\n       // Configure the port for web socket listening\n       port: 9802\n       // Configure the host for web socket listening\n       host: 'localhost',\n       // Files to ignore when configuring file monitoring\n       ignores: ['auto_generated/*']\n     }\n     //...\n   }\n});\n"})}),"\n",(0,o.jsx)(n.h4,{id:"hmrport",children:(0,o.jsx)(n.code,{children:"hmr.port"})}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"default"}),": ",(0,o.jsx)(n.code,{children:"9801"})]}),"\n"]}),"\n",(0,o.jsx)(n.p,{children:"The port the Web Socket server listens on"}),"\n",(0,o.jsx)(n.h4,{id:"hmrhost",children:(0,o.jsx)(n.code,{children:"hmr.host"})}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"default"}),": ",(0,o.jsx)(n.code,{children:"localhost"})]}),"\n"]}),"\n",(0,o.jsx)(n.p,{children:"Host on which the Web Socket server listens"}),"\n",(0,o.jsx)(n.h3,{id:"proxy",children:"proxy"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Default value"}),": ",(0,o.jsx)(n.code,{children:"undefined"})]}),"\n"]}),"\n",(0,o.jsxs)(n.p,{children:["Configure server proxy. farm uses ",(0,o.jsx)(n.code,{children:"http-proxy"})," as a proxy for the development server. Based on ",(0,o.jsx)(n.a,{href:"https://github.com/http-party/node-http-proxy?tab=readme-ov-file#options",children:"http-proxy"})," implementation, specific options refer to its documentation, example:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-ts",children:'import { defineConfig } from "@farmfe/core";\n\nfunction defineConfig(config: UserConfig) {\n  return config;\n}\n\nexport default defineConfig({\n  server: {\n    proxy: {\n      "/api": {\n        target: "https://music-erkelost.vercel.app/banner",\n        changeOrigin: true,\n        pathRewrite: (path: any) => path.replace(/^\\/api/, ""),\n      },\n    },\n  },\n});\n'})}),"\n",(0,o.jsx)(n.h3,{id:"open",children:"open"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"default"}),": ",(0,o.jsx)(n.code,{children:"false"})]}),"\n"]}),"\n",(0,o.jsx)(n.p,{children:"After the compilation is completed, the browser is automatically opened to the corresponding page."}),"\n",(0,o.jsx)(n.p,{children:"###host"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"default"}),": ",(0,o.jsx)(n.code,{children:"localhost"})]}),"\n"]}),"\n",(0,o.jsx)(n.p,{children:"The host that the Dev Server listens on."}),"\n",(0,o.jsx)(n.h3,{id:"plugins",children:"plugins"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"default"}),": ",(0,o.jsx)(n.code,{children:"[]"})]}),"\n"]}),"\n",(0,o.jsx)(n.p,{children:"Configure the Dev Server plug-in of Farm, through the Dev Server plug-in, you can extend the context of DevServer, add middleware, etc. A plugin is a function. Examples of plugins are as follows:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-ts",children:"export function hmrPlugin(devServer: DevServer) {\n  const { config, logger } = devServer;\n  if (config.hmr) {\n    devServer.ws = new WebSocketServer({\n      port: config.hmr.port,\n      host: config.hmr.host,\n    });\n    devServer.app().use(hmr(devServer));\n    devServer.hmrEngine = new HmrEngine(\n      devServer.getCompiler(),\n      devServer,\n      logger\n    );\n  }\n}\n"})}),"\n",(0,o.jsxs)(n.p,{children:["Then configure the plugin into ",(0,o.jsx)(n.code,{children:"server.plugins"}),"."]})]})}function a(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(h,{...e})}):h(e)}},5296:(e,n,r)=>{r.d(n,{R:()=>t,x:()=>l});var o=r(758);const i={},s=o.createContext(i);function t(e){const n=o.useContext(s);return o.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:t(e.components),o.createElement(s.Provider,{value:n},e.children)}}}]);